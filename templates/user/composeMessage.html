{% extends 'base_forms.html' %}
{% block content %}

<script src="/static/jquery-1.8.3.min.js" type='text/javascript'></script>
<script type='text/javascript'>
	function validation(){
		var receiver=document.getElementById('receiver');
		var subject=document.getElementById('subject');
		var address=document.getElementById('address');

		if(receiver.value.length == 0){
			alert('Please enter a receiver id');
			receiver.focus();
			return false;
		}else if(subject.value.length == 0){
			alert('Please enter a subject');
			subject.focus();
			return false;
		}else if(message.value.length == 0){
			alert('Please enter a address');
			address.focus();
			return false;
		}else{
			return true;
		}
	}
</script>
<script>
	$(document).ready(function(){
		$('#receiver').change(function(){
			var receiver=$('#receiver').val();
			$.ajax({
				url:"{% url 'checkReceiver' %}",
				data:{'receiver':receiver},
				success:function(data){
					if(data.valid != 'exist'){
						alert('Please enter a valid receiverid');
						$('#receiver').val('');
						$('#receiver').focus();
					}
				}
			})
		})
	})
</script>
	<div class="card-title">Compose Message</div>
        <hr>
	<form method='post' action="{% url 'composeMessageAction' %}">
	{% csrf_token %}
		<div class="form-group">
            		<label for="receiver">Email Id</label>
            		<input type="text" class="form-control" id="receiver" name='receiver' placeholder="Enter Mail Id" {% if receiver %} value='{{receiver}}' readonly {% endif %}>
           	</div>
           	<div class="form-group">
            		<label for="subject">Subject</label>
            		<input type="text" class="form-control" name='subject' id="subject" placeholder="Enter Your Subject" {% if subject %} value='{{subject}}' readonly {% endif %}>
           	</div>
           	<div class="form-group">
            		<label for="message">Message</label>
            		<textarea class="form-control" id="message" name="message" rows='6' placeholder="Enter Your Message" {% if message %} readonly {% endif %}> {% if message %} {{message}}{% endif %}</textarea>
           	</div>
		<div class="form-group">
            		<input type="submit" class="btn btn-light px-5" value='SEND' onclick='return validation()'>
          	</div>
	</form>

<!---------------------------------------------------------------------------------------------------------------------------------->
	
		<!--<form method='post' action="{% url 'composeMessageAction' %}">
		{% csrf_token %}
			<table>
				<tr>
					<td>Receiver:</td>
					<td>
						{% if receiver %}
							<input type='text' name='receiver' id='receiver' value='{{receiver}}' readonly />
						{% else %}
							<input type='text' name='receiver' id='receiver' />
						{% endif %}
					</td>
				</tr>
				<tr>
					<td>Subject:</td>
					<td>
						{% if subject %}
							<input type='text' name='subject' id='subject' value='{{subject}}' readonly />
						{% else %}
							<input type='text' name='subject' id='subject' />
						{% endif %}
					</td>
				</tr>
				<tr>
					<td>Message:</td>
					<td>
						{% if message %}
							<textarea name='message' id='message' rows='4' cols='21' readonly>{{message}}</textarea>
						{% else %}
							<textarea name='message' id='message' rows='4' cols='21'></textarea>
						{% endif %}
					</td>
				</tr>
				<tr>
					<td></td>
					<td><input type='submit' value='SEND' onclick='return validation()' /></td>
				</tr>
			</table>
		</form>-->
	
	{% if messages %}
		{% for msg in messages %}
			<script>
				alert('{{msg}}')
			</script>
		{% endfor %}
	{% endif %}
{% endblock %}