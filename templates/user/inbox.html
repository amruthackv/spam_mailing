{% extends 'base_forms.html' %}
{% block content %}

<script src="/static/jquery-1.8.3.min.js" type='text/javascript'></script>
<script>
	$('.card').on('click','.viewMail',function(){
		var msgId=$(this).data('msgid');
		console.log(msgId);
		$.ajax({
			url:"{% url 'viewMail' %}",
			data:{'msgid':msgId},
			success:function(data){
				$('.subject').html(data.subject);
				$('.username').html(data.username);
				$('.date').html(data.date);
				$('.time').html(data.time);
				$('.message').html(data.message);
				$('.links').html();
				$('#senderid').val(data.senderid);
			}
		})
	})
</script>

<h5 class="card-title">Inbox</h5>
<div class="table-responsive">
	<form method='post' action="{% url 'moveToTrash' %}">
	{% csrf_token %}
		<table class="table table-hover">
                	<thead>
                  		<tr>
					<th></th>
                    			<th scope="col">Sender</th>
                    			<th scope="col">Subject</th>
                    			<th scope="col">Message</th>
                    			<th scope="col">Date</th>
                    			<th scope="col">Time</th>
					<th></th>
					<th></th>
                  		</tr>
                	</thead>
                	<tbody>
                  		{% for v in data %}
					<tr>
						<td><input type='checkbox' name='trashCheck' value='{{v.id}}' /></td>
						<td>{{v.senderid.username}}</td>
						<td>{{v.subject}}</td>
						<td>{{v.message}}</td>
						<td>{{v.date}}</td>
						<td>{{v.time}}</td>
						<td><a class="viewMail" data-toggle="modal" data-msgid='{{v.id}}' data-target="#myModal">View</a></td>
						<td><a href="{% url 'replyToMail' v.id %}">Reply</a></td>
						<td><a href="{% url 'forwardMail' v.id %}">Forward</a></td>
					</tr>
				{% endfor %}
                	</tbody>
		</table>
		<br>
		<input type='submit' value='Move to Trash' class="btn btn-light px-5" />
	</form>
</div>
<div id="myModal" class="modal fade" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content bg-theme bg-theme1  pace-done">
			<div class="card">
            			<div class="card-body">
					<h5 class="mb-3 subject">User Profile</h5>
					<div class="row">
                        			<div class="col-md-6">
							<h6 class='username'>Username</h6>
							<p><span class='date'>Date</span>, <span class='time'>Time</span></p>
						</div>
                        			<div class="col-md-6" >				
								<input type='hidden' id='senderid' name='senderid' />
								<!--<a id='replyTomail'  href="">Reply</a>-->
								 {% for v in data %}<script>if({{v.id}} == $('#senderid').val()){ }</script><a href="{% url 'replyToMail' v.id %}">Reply</a> {% endfor %}
								
							
						</div>
					</div>
					<div class="row">
						<p class='message'>Message</p>
					</div>
				</div>
			</div>
    		</div>

	</div>
</div>

<!---------------------------------------------------------------------------------------------------->
	    <!--<h3></u>Inbox</u></h3>
	    <form method='post' action="{% url 'moveToTrash' %}">
	    {% csrf_token %}
		<table>
			<tr>
				<th></th>
				<th>Sender</th>
				<th>Subject</th>
				<th>Message</th>
				<th>Date</th>
				<th>Time</th>
			</tr>
			{% for v in data %}
				<tr>
					<td><input type='checkbox' name='trashCheck' value='{{v.id}}' /></td>
					<td>{{v.senderid.username}}</td>
					<td>{{v.subject}}</td>
					<td>{{v.message}}</td>
					<td>{{v.date}}</td>
					<td>{{v.time}}</td>
					<td><a href="{% url 'replyToMail' v.senderid.id %}">Reply</a></td>
					<td><a href="{% url 'forwardMail' v.id %}">Forward</a></td>
				</tr>
			{% endfor %}
		</table>
		<input type='submit' value='Move to Trash' />
	    </form>
		<a href="{% url 'viewTrash' %}">View Trash</a>-->
{% endblock %}